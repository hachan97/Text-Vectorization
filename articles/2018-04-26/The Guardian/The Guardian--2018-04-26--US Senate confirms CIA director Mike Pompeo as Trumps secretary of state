The Senate narrowly confirmed Mike Pompeo to be secretary of state on Thursday, clearing the path for him to take over as the top US diplomat just as President Donald Trump faces high-risk moments on Iran and North Korea.

Pompeo, the outgoing CIA director, secured support from 57 senators, with 42 voting no one of the slimmest margins for the job in recent history. Every past nominee for the job since at least the Carter administration has received 85 or more yes votes in the Senate, with the exception of Trumps first secretary of state, Rex Tillerson, who got 56.

He is expected to be sworn into office immediately and then to depart within hours of the vote for Europe on his first trip as secretary of state.

Pompeo, a former Kansas congressman, is expected to guide Trumps foreign policy in a more right-leaning direction than Tillerson, the former Exxon Mobil CEO fired by Trump on Twitter last month. He inherits a state department and diplomatic corps that is deeply demoralized after a tumultuous first year under Tillerson, who pushed budget and staff cuts and eschewed public appearances while leaving key diplomatic positions unfilled.

The Senate vote followed an uneasy confirmation process for Pompeo that underscored Donald Trumps growing difficulties in getting nominees in place for top positions. On Monday, it appeared Pompeo would fail a vote in the Senate foreign relations committee, but the panel ultimately cleared him after last-minute support from Republican Rand Paul of Kentucky.

A long list of pressing issues awaits him including a decision on the Iran nuclear deal and Trumps upcoming summit with North Korean leader Kim Jong-un.

Previously confirmed by the Senate for the CIA job, Pompeo was supported by all the Republican senators and by six Democrats. The Democrats included several up for re-election in conservative-leaning states, including Heidi Heitkamp of North Dakota and Joe Manchin of West Virginia. John McCain of Arizona, who is being treated for cancer, was absent.

In the run-up to Pompeos confirmation, his backers emphasized his resume as a West Point and Harvard law school graduate and former congressman who enjoys a close relationship with Trump particularly on North Korea. Pompeo, as CIA director, traveled to Pyongyang over Easter after being nominated for secretary of state. In the North Korean capital he met Kim ahead of the planned meeting with Trump, expected in late May or June.

Hes the perfect person to come in at this time and lead those efforts on North Korea, Tennessee Republican Bob Corker said on the Senate floor moments before Pompeo was confirmed.

Yet his opponents had warned that his hawkish foreign policy views and negative comments about gay marriage and Muslims made him ill-equipped to serve as a diplomat or to represent the United States on the world stage. Pompeo used his confirmation hearing to try to soften that image, edging away from past comments about regime change in North Korea.