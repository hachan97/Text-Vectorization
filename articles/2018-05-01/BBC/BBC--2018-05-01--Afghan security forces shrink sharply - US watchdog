The strength of the Afghan security forces has declined sharply over the past 12 months, a US government watchdog has said, amid reports of desertions and high casualty rates.

The number of security forces personnel has fallen by about 10% to just under 300,000, according to a new report.

The findings come a day after a wave of attacks killed nearly 40 people.

The defence ministry rejected the findings, telling the BBC the army had enough soldiers to fight the militants.

"We have enough soldiers, enough ANA (Afghan National Army) units, to fight the militants and other mafia groups. We reject the Sigar report on numbers. It's not 100% fact," a spokesman told the BBC.

"The morale of our soldiers is very high and as of now there are 11 operations going on across the country."

The report, released by Sigar [the Special Inspector General for Afghanistan Reconstruction], says more of the population is falling under the control of militant groups including the Taliban.

It says the Taliban and other militants groups now control or influence 14.5% of Afghanistan's 407 districts - the highest level since the group started recording such data in late 2015.

"Building up the Afghan forces is a top priority for the US and our international allies, so it is worrisome to see Afghan force strength decreasing," John Sopko, the head of Sigar, told Reuters news agency.

US-led forces have spent billions of dollars trying to defeat the Taliban.

Despite this, Taliban fighters are openly active in nearly three-quarters of the country, a BBC study earlier this year found. The research also suggested that the Islamic State (IS) group is more active in Afghanistan than ever before, although it remains far less powerful than the Taliban.

The Afghan government says it controls most areas. But attacks claimed by Taliban and IS militants have killed scores in Kabul and elsewhere in recent months.

On Monday twin attacks claimed by IS in the capital left 26 people dead, nine journalists and photographers among them. BBC reporter Ahmad Shah was killed by unidentified gunmen in a separate attack in the eastern province of Khost.

US forces used to tell Sigar how many Afghan soldiers had been killed each year, but that information is now withheld at the request of the government in Kabul.

Last August, with the Taliban gaining ground and security deteriorating, President Donald Trump announced the US military would stay in the country indefinitely. The Pentagon said it would send 3,000 extra troops.

More than 8,000 US special forces remain in the country backing Afghan troops, although Nato combat operations officially ended in 2014.

Violence has soared since then. Major attacks occur with greater frequency and the Afghan security forces appear unable to stop them.