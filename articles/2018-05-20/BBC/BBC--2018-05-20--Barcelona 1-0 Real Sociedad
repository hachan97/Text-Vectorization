Andres Iniesta capped his stellar career at Barcelona with victory over Real Sociedad in his final game.

The Spain midfielder, 34, is leaving the La Liga champions at the end of the season after winning 22 major titles in 16 years with the senior side.

Fans formed a mosaic with the message 'Forever Iniesta' prior to the game.

Iniesta was typically assured in possession but the tired hosts needed a stunning strike by Philippe Coutinho to end their season with a win.

The former Liverpool midfielder cut in from the left and curled a powerful effort in off the far post on 57 minutes.

Iniesta, who captained the side, was replaced in the 82nd minute, embracing all of his team-mates and acknowledging the Nou Camp crowd with tears in his eyes.

After full-time the stadium went dark before a light show during which the Barcelona players emerged wearing Iniesta shirts to form a guard of honour.

The man himself then strode out to raise first the La Liga then the Copa del Rey trophies, the fourth time he has won both in the same season, before addressing the crowd.

"This is a difficult day but I have spent 22 marvellous years here," he said. "It's been a pride and a pleasure to defend and represent this badge, which for me is the best in the world.

"Thanks to all my team-mates, each and every one. I will miss you all so much. And thank you to the fans, for all your love, everything you've made me feel since I arrived here as a boy. I leave as a man. I will keep you in my heart forever."

Having joined the Barcelona youth set-up aged 12, Iniesta ends his 22-year association with the club after making 674 senior appearances, second only to long-time central midfield partner Xavi who made 767 and was present in the stadium.

He was part of Barca sides that won La Liga nine times, four Champions League titles, three Club World Cups and six Copa del Rey trophies. The last of the league titles came this season as Barcelona almost went the whole campaign unbeaten, only to fall to a 5-4 defeat by Levante in their penultimate game.

The hosts were subdued against a stubborn Real Sociedad, the game itself of secondary importance to bidding farewell to one of their greatest ever players.

Lionel Messi even started on the bench before replacing Coutinho on 67 minutes to enjoy a final cameo alongside Iniesta, the pair having won all 22 of those trophies together.

When granted an emotional send-off in being replaced by Paco Alcacer, Iniesta went straight to Messi, handing over the captain's armband and hugging the Argentina striker.

He could not quite toast his final game with a goal - he came closest in dragging a shot narrowly wide on nine minutes - but showed plenty of his trademark deft touches, slick passes and quick feet throughout.

Iniesta, who has been linked with a move to the Chinese Super League but not said where he will play next season, now turns his attention to this summer's World Cup in Russia, with Spain's squad for the tournament set to be announced on Monday.

In 129 international appearances to date, he scored the winning goal in the 2010 World Cup final and also won the European Championship in 2008 and 2012.

In a weekend of farewells - Gianluigi Buffon played his final game for Juventus, Fernando Torres said goodbye to Atletico Madrid, while this match was also Xabi Prieto's last for Real Sociedad - Iniesta had the most ostentatious send-off, the Barcelona squad still gathered on the pitch an hour after the final whistle to watch a fireworks show.