When Pope Francis visits the Irish Republic, in August, the first papal visit for almost 40 years he will find a country wrestling with its relationship with Catholicism.

Thirty-nine years ago Michael McLoughlin, an accountant from County Tipperary, was beyond excited.

Pope John Paul II was visiting Ireland, and Michael's church choir had been chosen to sing at a Mass for young people in Galway.

"Whatever your favourite rock gig that you ever wanted to be at in your whole life, this was it," said Michael. "And you had a backstage pass."

But somewhere between 1979 and 2018, Michael, like thousands of other Irishmen and women, lost his faith.

John Paul II drew crowds of over 2.5 million in September and October 1979.

It is thought that about one third of Ireland's population attended his Mass in Phoenix Park in Dublin.

Pope Francis will also celebrate Mass in Phoenix Park, but it is not clear whether his audience will be on the same scale.

While the Irish census put the number of self-described Catholics at 3.73 million in 2016 - about 78% of the population - the number attending church has dropped.

The Church's most recent available statistics show that weekly Mass attendance fell from 63% in 2002 to 48% in 2010.

Those same figures show that even then, just under a quarter of 26- to 34-year-old Catholics in Ireland attended Mass weekly.

The Archbishop of Dublin, the the Most Reverend Diarmuid Martin, said in a recent lecture that in some churches in his diocese only 2% of people went to Mass.

He quoted some research findings that predict Mass attendances could drop by 33% by 2030.

This reflects an Ireland that is much more secular. And Michael McLoughlin puts the blame on multiple sex scandals and abuse cases involving priests.

"The scandals that have rocked the Church have framed a lot of the way people think nowadays about the Church," he said.

"They don't have that same respect for the Church that they would have had 40 years ago."

The Pope's visit will also take place exactly three months after a referendum on Ireland's constitutional ban on abortion.

The Church opposes the campaign to repeal the so-called "8th amendment", but it has high-profile support, including from current Prime Minister, Leo Varadkar.

In 2015 there was overwhelming support for changing the Irish constitution to allow same-sex couples to marry, despite opposition from the Church.

At the time, the Most Reverend Diarmuid Martin described the result as a "social revolution", and said the Church faced a "huge task" to get its message across to young people.

Standing outside an imposing building in the inner suburbs of Dublin's north side, Samantha Long recounts the horrors endured inside.

Gloucester Street Magdalene laundry was where her birth mother, Margaret Bullen, lived until she died aged 51.

The Catholic-run workhouses housed 10,000 so-called "fallen women" who were punished for their pregnancies by being made to work in punitive conditions, without pay.

More than a quarter of those who spent time in the laundries had been sent there by the Irish state.

Then Prime Minister Enda Kenny apologised for the treatment of the women in 2013.

Now, Samantha would like the Pope to do the same.

"The visit this time would be a great opportunity for the Pope to try to atone for the sins that were committed against children and men and women in this country, and might redeem something of that reputation that has suffered so much," she said.

This will be the second papal visit to Ireland - and the second time Pope Francis has been to the country.

As Father Jorge Bergoglio, he visited the Jesuit community at Milltown Park in Dublin in 1990.

Jesuits are members of a religious order who take vows of poverty, chastity and obedience. And Francis is the first Pope from among their number.

Father Bergoglio's name, slightly misspelled, has been found in a ledger book at the Dublin seminary.

It records that the future leader of the world's Catholics spent 104 on board and lodging during his 23-day stay.

Another Jesuit, Father Michael O'Sullivan, met him briefly in the refectory one evening during that visit.

"I still remember to this day how he looked at me," he said. "There was just something about him - the way he could look at you and be really present, and really be hearing what you were saying."

But Father O'Sullivan acknowledges that as Pope he will visit a different Ireland.

"There will be a lot of people who would be very uplifted by him coming here," he said. "But I also have some worries about it because the Catholic Church now in Ireland is in a difficult place."