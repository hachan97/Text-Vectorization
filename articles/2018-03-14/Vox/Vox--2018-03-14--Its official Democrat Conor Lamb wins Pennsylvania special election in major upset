In a stunning upset, Democrat Conor Lamb won an incredibly close special election in Pennsylvanias 18th Congressional District, beating out Republican candidate Rick Saccone in a deeply conservative district the nonpartisan Cook Political Report rated R+11.

The race stretched into Wednesday midday, when CNN reported Lamb was in the lead with 627 votes, with 100 percent of precincts reporting. State law does not mandate a recount in district-level elections.

Conventional wisdom suggested that Saccone  a candidate who once declared himself Trump before Trump was Trump  would do well in a district that turned out in droves for President Donald Trump in 2016. But in recent weeks, Republicans were in full panic mode, dumping more than $9 million into the race. Lambs victory shows they were right to be so worried.

And it wasnt just Republicans who feared losing this district  it was Trump himself.

In many ways, PA-18 was emblematic of Trumps presidential success story; the president carried the district by 20 points in 2016, along with much of the rest of western Pennsylvania. Pennsylvania was one of the blue-collar Rust Belt states he was never supposed to win but won anyway, in a stunning rebuke to Hillary Clinton.

Along with Wisconsin and Michigan, the Keystone State carried Trump to victory on Election Day 2016. Its a story he often recounts at rallies, including the one he held for Saccone in Moon Township, Pennsylvania, on Saturday.

Voting for Saccone is exactly what the president wanted his supporters to do. Trump cared enough about Saccone winning that he joined him on the campaign trail multiple times and sent Vice President Mike Pence and members of his family, including son Donald Trump Jr. and daughter Ivanka Trump, to stump.

He even pushed a controversial announcement on steel and aluminum import tariffs so it would land a week before the special election.

None of it worked.

Trump voters ended up either staying home or proving they could just as easily cast their votes for a Democrat with the right message, especially when Trump wasnt the candidate on the ballot.

On its face, Tuesdays special congressional election in the southwest corner of Pennsylvania was supposed to be a breeze for the GOP. The Cook Political Report rated the district R+11, due in part to partisan gerrymandering that the state Supreme Court recently ruled unconstitutional.

Political analysts in the state agreed that the districts gerrymandering was part of the reason it was supposed to be impossible for Democrats to win. This is a seat that used to be so solidly Republican that Democrats didnt even bother competing in it.

The seat had since 2003 been held by Republican Rep. Tim Murphy, who was so secure in his seat that he often failed to attract a Democratic challenger. Murphy suddenly resigned in October amid revelations that he had pressured a woman with whom he was having an extramarital affair to have an abortion.

But even after he stepped down, national Democrats didnt think they could compete in the special election, one Democratic Congressional Campaign Committee (DCCC) operative told Vox.

That was until Conor Lamb came along.

A 33-year-old Marine and former assistant US attorney who prosecuted drug dealers in the midst of Pennsylvanias deadly opioid crisis, Lamb comes from a well-known political family in Pittsburgh but is new to politics himself.

He struck a decidedly independent tone throughout the campaign, making headlines when he said he would not support House Minority Leader Nancy Pelosi as the Democratic leader if a blue wave swept the House in 2018, echoing his support for the Second Amendment, and telling voters he personally doesnt believe in abortion (though he supports Roe v. Wade as the law of the land).

Hes got local ties; hes a local guy, Tim Waters, the political director for the United Steelworkers Political Action Committee, told Vox. Hes a young guy with a lot of energy ... right down the line on issues that affect workers in this district.

Lambs independent streak has also made it difficult for Republicans to attack him as a politician in step with Pelosi, although they certainly tried. Republicans and conservative groups have mostly been trying to tie Lamb to the Democratic agenda.

But throughout the campaign, there was not a lot of evidence it was sticking.

Focused almost exclusively on local issues, Lamb has nevertheless stumbled into a long-running debate about how the Democratic Party can claw its way back to the majority after 2016.

Trying to recapture blue-collar workers, Lambs campaign represents one school of thought  going back to labor-liberal economic values and working with unions to retake territory in Midwest and Rust Belt states that voted for Trump in 2016.

PA-18 is often characterized as a conservative district, but it has deep Democratic roots as well.

Its not so much a conservative district as it is an economic populist district, said longtime Pennsylvania Democratic consultant Mike Mikus. You dont have to support the NRA down the line, but respect the right of people to own firearms ... and [be] someone thats willing to stand up to the national party when they feel its in the interest of the district or the region.

There are technically 70,000 more registered Democrats in the 18th Congressional District than Republicans, but many of those voters have been casting ballots for GOP candidates for years. Mikus, who has worked on Democratic campaigns in the state for years, said Lamb successfully proved himself an independent.

Conor, I think so far, has done a fairly good job of portraying himself as someone thats going to fight for the region, he said.

Lambs campaign was not against Trump. The former federal prosecutor rarely mentioned the president at his events, instead focusing on issues like protecting entitlements such as Social Security, Medicaid, and Medicare and ending Pennsylvanias opioid crisis, for which Gov. Tom Wolf recently declared a state of emergency  in other words, many of the same themes Trump echoed during his 2016 presidential campaign.

From the beginning of his campaign, Trump vowed not to cut entitlement programs like Social Security and Medicare. Then when he got into office, his 2019 budget proposed cutting Medicare by $236 billion over 10 years. (Those cuts have not been enacted.)

Trump promised many times to end the opioid crisis thats ravaging Pennsylvania, West Virginia, and other Rust Belt states. In 2016, it claimed more American lives than the entire Vietnam War.

The presidents response has been to declare the opioid epidemic a public health emergency, but little else. The administration has largely ignored the recommendations of Trumps opioids commission, Trump has twice tried to strip his Office of National Drug Control Policy of funding and proposed the death penalty for drug dealers. Congress recently appropriated $6 billion for treatment, which experts say falls dramatically short of whats needed.

Even so, Trump has remained relatively popular inPennsylvanias 18th District. Saccone was unable to replicate that popularity for himself.

All special elections since Trumps inauguration have been declared a referendum on Trump by pollsters and the media. But Pennsylvania is arguably one of the few Trump actually cared about because the state was one of his greatest 2016 success stories.

He won Pennsylvania by a little over 73,000 votes, 48.2 percent to Clintons 47.5 percent. The roughly 1 percentage point that separated the two candidates was seismic; it delivered Trump 20 Electoral College votes and was part of the Wisconsin, Michigan, and Pennsylvania trifecta that pushed him to the presidency.

Trump was never supposed to win Pennsylvania; the fact that he claimed the state in 2016 became an integral part of his narrative, one that he repeated at Saccones Saturday rally.

On November 8, Pennsylvania is the state that gave us the 45th president of the United States, Trump said, as the crowd cheered.

Youre one of us! one crowd member yelled.

They said we couldnt get elected, Trump continued. I say we ... because some of you had never voted before, but you love the country. Remember, they said, You cannot win. Remember the famous 270? Remember, they said he cannot get to 270. And we didnt; we got to 306.

For Republicans, there was a mad dash to pour cash into the race so they didnt embarrass themselves by losing a district that Democrats were never even supposed to be competitive in. But for Trump, the impetus was much more personal.

Trumps push wasnt about Saccone, it was about hanging on to Trump country in southwestern Pennsylvania  and with it, the very narrative that put him in the White House. For the president who prizes loyalty, this race was the ultimate test.

Normally I would not come, except its Pennsylvania, Trump said on Saturday. I love Pennsylvania.