Congress has to strike a deal on federal spending by midnight on March 23 or the government will run out of money and shut down  again.

But with less than week to pull together a massive spending bill, negotiations still have hangups, and lawmakers are taking the fight down to the wire.

The government has already shut down twice this year. The first shutdown came in January and lasted for three days, during a standoff over the future of the Deferred Action for Childhood Arrivals program. Then in February, Sen. Rand Paul (R-KY) effectively shut down the government himself, this time only for a few hours overnight, in a stand against a deal negotiated by congressional leaders that would bust the government budget caps on domestic and military spending that have been in place since 2013.

DACA has largely been off the table this time. And having kicked down any permanent solution to government spending since September 2017, and currently on their fifth short-term spending bill, Congress has been working toward a more permanent funding package to carry them through to the start of the new fiscal year on September 30. But theres been some head-butting between the parties thats slowed down negotiations.

Republicans are trying to slip in conservative priorities  like hiking spending for the Department of Homeland Security to expand the number of immigrant detainee beds  and Democrats are pushing for a liberal spending agenda, prioritizing non-defense spending programs. While Democrats dont have control of either chamber, they can block funding through a filibuster in the Senate.

Republicans need at least nine Senate Democrats to sign on to their spending agenda for it to pass. Meanwhile, theres still a big question mark over what the White House will sign on to. President Trump has called for some hardline spending priorities  like defunding sanctuary cities and border wall funding that Democrats will almost certainly oppose.

But with the midterm elections around the corner, theres little appetite in Congress for another government shutdown, and lawmakers seem more willing to let their controversial policy priorities fall to the side.

In February, lawmakers set themselves up to reach a more permanent spending agreement by the end of March. Congress agreed to increases to domestic and defense spending over the next two years, raising funding for domestic programs by $128 billion and hiking defense budgets by $160 billion. But they didnt actually decide where the money would go.

Since passing the budget deal, appropriators  the lawmakers in charge of the nations purse strings  have been negotiating how to allocate the money. With only a few days left until the government shutdown deadline, lawmakers are still butting heads over 20 to 25 provisions, one Democratic aide close to negotiations said.

That means this could end in one of three ways by March 23:

1) Congress can pass a long-term spending bill. This would fund the government through the end of September  the end of the 2018 fiscal year  and come in the form of an omnibus, which jams together 12 individual appropriations bills into one funding package. Senate and House appropriators have been working to write the omnibus over the past several weeks, but there are still policy hang-ups that are running down the clock.

The roadblocks? Its coming down to a fight over how to fund the Department of Homeland Security and health care.

Talks over funding that would help lower health care premiums on the Obamacare exchanges have also hit a snag. After Republicans voted to repeal the Affordable Care Acts individual mandate, which taxed individuals for not having health insurance, premiums are expected to rise by 10 percent, according to projections from the Congressional Budget Office. Conservatives deride the whole effort as bailing out a failed health care policy and Republican leaders are pushing to attach language that would prevent the Obamacare payments from going toward any insurance plan that covers abortions  which Democrats say would adversely impact low income women.

Neither party seems willing to concede, making it increasingly possible that the Obamacare stabilization funding might be dropped all together.

On immigration, lawmakers went into the week at odds over a Republican call to hike funding for DHS to boost interior enforcement of illegal immigration, which Democrats say will only increase efforts to deport nonviolent undocumented immigrants, who are typically deprioritized.

Funding for the border wall is also a point of contention. GOP leaders are eyeing $1.6 billion for Trumps pet project, that Democrats have long pledged to block. The White House tried to strike a last minute $25 billion for the border wall for a short-term DACA fix exchange, which Democrats balked at.

Theres also still an open question over including funding for the Gateway project  an infrastructure initiative to build a commuter rail tunnel between New York and New Jersey under the Hudson River. It has bipartisan support in Congress, but Trump has vowed to veto the funding (possibly because of a feud with New York Democrat Sen. Chuck Schumer.)

2) Congress could buy itself more time. If lawmakers cant settle their differences on the omnibus by the end of this week, lawmakers also have the option to give themselves another extension on the government shutdown deadline. By passing a short-term bill  a continuing resolution  Congress would be keeping spending levels at the status quo.

Already, rumblings among congressional staffers hint that negotiations could come down to another CR (Its not clear how long a stopgap funding bill that could be). It would be the sixth stopgap spending bill this fiscal year  a reality thats increasingly frustrated lawmakers, especially those with defense interests who say the military cannot properly plan its resources on short-term spending bills.

3) The government shuts down. Three government shutdowns in one year would certainly be historic. This would be the result of a complete or partial failure in negotiations, depending on which parts of the spending bill cant be agreed on. For example, if lawmakers agree to fund everything but the Department of Homeland Security, only DHS-related government activity would shutdown.

A shutdown could also come from the White House, if Trump chooses to veto the final spending bill.

House Speaker Paul Ryan and Senate Majority Leader Mitch McConnell are likely much less eager go down that path, especially as we creep closer to midterm elections. But Trump has not shied away from threatening a government shutdown in the past, once even calling for one to get a win on his policy priorities.

Behind both government shutdowns this year was a policy fight not directly tied to government spending: immigration.

In January, Senate Democrats, frustrated with Trumps unwillingness to accept a bipartisan proposal to address the nearly 700,000 immigrants in legal limbo under DACA, orchestrated a shutdown with the support of some Republicans. The result was a failed and inconclusive Senate floor debate on the issue.

Again in February, a conservative revolt over the budget deal meant that House Republicans, who have a big enough majority to pass legislation without Democratic support, suddenly needed votes from across the aisle. Rand Paul shut down the government over frustration with the budget, and House Democrats had to decide whether they would sign on to reopening it without any gains on immigration. Ultimately, House and Senate Democrats voted for the final bill.

Democrats seem to have changed their tune on DACA and seem less interested in tying big policy priorities, including issues like gun control, to the spending fight. A DACA fix doesnt have to be on the omnibus bill, House Minority Leader Nancy Pelosi said last week. But the omnibus bill has other problems in it.

Pelosi is referring to a different immigration fight to be had with this spending bill.

Republicans want more funding for DHS to both increase the number of beds for immigrant detainees and to expand the enforcement force, with funding to hire 1,000 more Immigration and Customs Enforcement agents and 500 more Customs and Border Protection officers.

Democrats say that CBP and ICE have failed to fill the positions they currently have funding for and that increasing the number of detainee beds will only increase the number of detainees, including children  pointing to the Trump administrations current family detention efforts on the border, which in some cases have separated children from their parents.

Its wasteful, and its harmfully targeting and deporting non-criminal immigrants, separating families and terrorizing frankly whole communities, Rep. Michelle Lujan Grisham (D-NM), who chairs the Congressional Hispanic Caucus, told reporters.

Trump has some immigration priorities of his own, including funding for the border wall and his call for Congress to defund sanctuary cities.

Today I am calling on Congress to stop funding sanctuary cities so we can save American lives, Trump said at a rally in mid-March. The funding bill should not give precious and massive taxpayer grants to cities aiding and abetting criminals.

His administration even recently floated a deal swapping a border wall for a DACA fix, which would fully fund the border wall at $25 billion in exchange for a two year extension of DACA. The idea largely fell flat in Congress, where Democrats want Trump to sign on to a path to citizenship. It doesnt appear that members of Congress, including Republicans, have much of an appetite for larger policy fights outside of the spending bill.

But as with all spending bills, the White House has the final say, and if Trump says he would veto the spending bill over these measures, it could spell more trouble for government spending.