It is suddenly a very real possibility that the federal government will shut down at 12:01 am Eastern time Friday for the second time in three weeks. Federal agencies have been told that they should prepare for a government shutdown.

The current federal spending plan expires at midnight. Congressional leaders have struck a deal that would fund the government through March 23 and set up a two-year budget agreement.

But there are two big roadblocks standing in the way of that plan passing Congress and averting another shutdown.

First, Sen. Rand Paul (R-KY) is threatening to prevent the Senate from voting on the new proposal in time, angry over the plan to add hundreds of billions of dollars in federal spending in the next few years.

The Senate will vote, eventually, though, and the spending plan is expected to pass the upper chamber. But in the House, a revolt from archconservatives means Republican leaders will need Democratic votes to keep the government open  and its not clear right now that they have them. Democratic leaders want assurances that the House will advance legislation addressing the Deferred Action for Childhood Arrivals program that would give deportation protections to unauthorized immigrants brought to the United States as children. Thats the same immigration issue the government shut down over last time.

House Minority Leader Nancy Pelosi has dug in against the budget deal without an immigration agreement, speaking on the House floor for hours on Wednesday in a passionate plea to resolve the issue.

Anyone that underestimates the ability of Nancy Pelosi to influence the Democratic caucus shouldnt be in the business that you are in, Rep. Brad Sherman (D-CA) told reporters on Thursday evening, as the shutdown rapidly began to look more plausible.

Republican leaders and their aides have been projecting confidence that a spending bill will get passed before the midnight deadline. But with Paul becoming more entrenched and Democrats in the House failing to unite around a set strategy, it is a real possibility that the government will shut down  at least technically  for a few hours.

Whether it stays shut down into Friday morning, with workers furloughed, likely depends on the House. But the first problem is in the Senate.

To pass a bill before the government shuts down at midnight, Senate leaders need the agreement of every senator to hold a vote. But Paul is still withholding his consent, angling for a vote on his amendment that would instead preserve the so-called sequestration budget caps. He took to the Senate floor a little before 6 pm to rail against the budget deal, which suggests he is digging in in this shutdown showdown.

Voxs Tara Golshan ran through the particulars of the spending deal that Senate leaders announced earlier this week. It would fund the government through March 23, in order to give congressional staff the time to write bigger appropriations bills that would actually fund the federal government for the next two years, under the parameters laid out in the budget deal that Congress is about to pass at the same time.

This is what Paul, one of the Senates foremost budget hawks, opposes. He believes the spending caps should be kept because federal spending is already too high.

It spends too much money, borrows too much money. Actually, were going to bring back Obama-era deficits. I was elected to combat Obama-era deficits, the Kentucky senator said on Fox News Thursday evening. Someone has to stand up and say, You should spend what comes in. We should balance our ledger. That used to be what it meant to be conservative.

But he is one of the few who feel that way, and under the Senate rules, the chamber can start voting at 1 am  with or without Paul. The short-term spending and long-term budget package is expected to receive broad support in the Senate.

But then it will head to the House, where its future is uncertain.

Both House Democrats and conservative Republicans are threatening to withhold support for a vote thats hours away.

For conservative Republicans, the budget deal, which Senate Majority Leader Mitch McConnell and Minority Leader Chuck Schumer announced yesterday, is too massive a spending increase. The proposal would increase investments in domestic programs and the military to the tune of $300 billion over the next two years, a major victory for Democrats concerned that a Republican-led government would slash federal programs.

But some Democrats are engaging in a high-risk, last-ditch strategy to ensure the House actually votes on immigration. With enough conservatives voting against the budget proposal, House Republicans need Democratic support to keep the government open. Despite supporting the budget deal on its merits, many House Democrats say they need a promise on a DACA vote as hundreds of thousands young immigrants fear losing protections from deportation and work permits by March 5.

The story changed throughout the day, with different leaders giving different instructions. Around 5 pm, Rep. Luis Gutierrez (D-IL), a leader on immigration issues, downplayed the shutdown talk. Sometimes there are whip operations where there are dire consequences for voting no, he told reporters. This whip operation is just informational. Its, How ya feeling?

On its face, its hard to parse Democratic leaders strategy here. Immigration activists have backed off calls for another government shutdown over DACA, especially after many saw the three-day shutdown in late January to be lacking much forethought. But after months of stalled bipartisan immigration negotiations, and a clear lack of urgency from Republican leadership, Democrats are trying to hold House Speaker Paul Ryans feet to the fire.

For months, congressional Republicans have asked Democrats to trust them on immigration. Vote to keep the government open and an immigration deal will come soon, they say.

These are talks that are occurring in earnest  we want to fix DACA, Ryan said before the last government shutdown in January.

But House Democrats have reason to be skeptical of Republican leadership on immigration. For all this insistence that negotiations are underway in earnest, House Minority Whip Steny Hoyer told reporters this week that he hadnt seen much progress on the immigration debate at all.

Since Trump announced in September that his administration would sunset DACA, fully ending the program on March 5, several proposals giving legal protections to the 690,000 undocumented immigrants in the program have cropped up  none of which have been endorsed or supported by GOP leadership.

Republican leaders, who were previously preoccupied with an Obamacare repeal effort and then a tax reform bill, instead spent months asking the White House for more clarity on Trumps vision for a DACA deal. Despite knowing an immigration bill will need bipartisan support to become law, Ryans only commitments on immigration have been to conservative immigration hardliners.

During the Houses last government spending fight three weeks ago, Ryan promised the House Freedom Caucus, a group of 40 ultraconservative lawmakers, that Republican leadership would whip votes for a conservative, partisan immigration bill. He also made assurances that he wouldnt bring up any immigration bill that didnt have the support of the majority of House Republicans  a promise that will prove increasingly difficult on such a contentious and dividing policy issue.

But its not only Ryan whos given Democrats pause. Immigration policy has a fraught history in the House: Former Republican Speaker John Boehner refused to bring up the Senates bipartisan Gang of Eight immigration bill for a vote.

Its a fresh memory for Democrats, who now want assurances that the 2018 immigration fight wont fall in the same limbo as in years past.