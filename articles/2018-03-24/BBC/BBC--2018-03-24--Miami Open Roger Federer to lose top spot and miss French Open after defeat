Roger Federer will lose his world number one spot after defeat at the Miami Open - and has announced he will miss the clay court season, including the French Open.

The 36-year-old, who suffered a shock 3-6 6-3 7-6 (7-4) loss to world number 175 Thanasi Kokkinakis in Miami, did not play on clay last season either.

Last year, he won Wimbledon after returning from his break.

The Swiss will be replaced by Rafael Nadal at the top of the new rankings.

On losing his world number one position, Federer - the defending Miami champion - said: "I deserve it after this match. I feel so bad."

After the defeat, he added: "I decided not to play the clay season."

Federer, who won his 20th Grand Slam at the Australian Open in January, began in typically assured style but was worn down by Australian qualifier Kokkinakis, 21, who won in two hours 21 minutes.

It was Federer's second loss in six days - he saw a 17-match unbeaten run come to an end in a gruelling match with Juan Martin del Potro in Indian Wells last weekend.

In Miami, he was up against another angular opponent in Kokkinakis, who used a vicious top-spin forehand to devastating effect.

"It felt like every time I had chances, something bad happened - wrong decision making by me, good decisions from him," he said.

"It's disappointing, I don't know why I could never get to a level I was happy with."

Federer made it very clear in Indian Wells that his participation in the clay-court season would be determined by what is best for him - and not by the fitness, or lack of fitness, of his chief rivals.

Much as he will be missed, his decision to skip the entire clay season does make perfect sense. He had actually played four more matches than last year heading into Miami, having won in Melbourne and Rotterdam before reaching the final at Indian Wells.

Although Federer won't be able to add to his tally of ranking points until June, he may well return to world number one before then. That is because Rafael Nadal has a mountain of points to defend on the clay having won last year in Monte Carlo, Barcelona, Madrid and Roland Garros.

Failing to defend any of those titles will cost him top spot.

Meanwhile, British number one Kyle Edmund lost 7-6 (7-4) 4-6 7-6 (7-5) to 20-year-old world number 63 Frances Tiafoe of the USA.

Edmund broke serve in the fifth game of the deciding set, but was broken back as he served for the match.

Tiafoe surged clear in the tie-break and, although the Briton saved five match points, Edmund eventually succumbed to defeat in two hours 25 minutes.

Tiafoe won his first ATP Tour event at the Delray Beach Open last month, beating Germany's Peter Gojowczyk in the final to become the youngest American to win a title since Andy Roddick in 2002.

In the men's doubles, Britain's Jamie Murray, seeded sixth with Brazilian partner Bruno Soares, advanced to the last 16.

The two-time Grand Slam winners recorded a 6-3 6-4 win over America's French Open doubles champion Ryan Harrison and Max Mirnyi of Belarus.

But Briton Dominic Inglot and New Zealand partner Marcus Daniell lost to the fourth-seeded Bryan brothers, Bob and Mike, the 16-time Grand Slam doubles winners, 10-3 in the deciding tie-break.