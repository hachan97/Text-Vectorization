CIA Director Mike Pompeo just received a confidence vote from the Senate Foreign Relations Committee to become the next US secretary of state  when just minutes before it looked like he would receive a historic rebuke.

On Monday evening, the committee  which is narrowly split with 11 Republicans and 10 Democrats  voted along party lines to endorse Pompeos nomination to the entire Senate. Sen. Rand Paul (R-KY) originally vowed not to vote for Pompeo. But, in an unexpected twist, the senator tweeted minutes before the vote that he changed his mind after speaking with President Donald Trump and Pompeo himself.

After calling continuously for weeks for Director Pompeo to support President Trumps belief that the Iraq war was a mistake, and that it is time to leave Afghanistan, today I received confirmation the Director Pompeo agrees with @realDonaldTrump, Paul tweeted. I have decided to support his nomination to be our next Secretary of State.

Asked about the Pompeo vote and Paul while alongside French President Emmanuel Macron on Monday evening, President Trump said Paul never let us down and that hes a good man.

But the unexpected drama doesnt end there. All Republicans originally voted in favor of Pompeo, while all Democrats voted against him  but Sen. Johnny Isakson (R-GA) was not present at the committee because he was giving a eulogy for a friend. He voted for Pompeo by proxy, but according to Sen. Bob Corker (R-TN), the committees chairman, the committee could not send Pompeos nomination to the floor with an endorsement unless all the present yes votes outnumbered the present no votes.

Sen. Chris Coons (D-DE), who originally voted no, then said he would vote present so the committee didnt have to wait until around 11 pm to vote in person. Coons also has a close relationship with Isakson and may have wanted to spare him having to formally vote late at night. The final tally ended 11 votes in favor of Pompeo, nine votes against, and one present (Coons). Because there were more present yes votes than present no votes, Pompeos nomination will now be sent to the Senate floor for a final confirmation vote.

Had the committee not endorsed Pompeo, he would likely have become the first Cabinet secretary of any kind to win their job without a committee endorsement since 1945, the Senate Historical Office told me. That dubious distinction is currently held by Henry Wallace, who served as commerce secretary from 1945 to 1946.

Most observers expect the Senate, where Republicans hold a 51-49 advantage, to officially confirm Pompeo because three Democrats have already said theyll vote for Trumps pick. The endorsements by Sen. Heidi Heitkamp (ND), Sen. Joe Manchin (WV), and Sen. Joe Donnelly (IN)  who are all up for reelection in states Trump won  will pave the way for Pompeo to become the nations chief diplomat.

So Pompeo avoided a massive embarrassment on Monday and will likely soon take over the State Department. But he surely wouldve wanted the Senate Foreign Relations Committee to endorse him in a more straightforward way than it just did.